{"version":3,"sources":["src/jquery.i18n.parser.js"],"names":["$","MessageParser","options","extend","i18n","parser","defaults","language","languages","String","locale","emitter","prototype","constructor","simpleParse","message","parameters","replace","str","match","index","parseInt","undefined","parse","replacements","indexOf","emit","ast","pipe","colon","backslash","anyCharacter","dollar","digits","regularLiteral","regularLiteralWithoutBar","regularLiteralWithoutSpace","escapedOrLiteralWithoutBar","escapedOrRegularLiteral","templateContents","templateName","openTemplate","closeTemplate","expression","paramExpression","result","pos","choice","parserSyntax","i","length","sequence","res","originalPos","push","nOrMore","n","p","parsed","makeStringParser","s","len","slice","makeRegexParser","regex","matches","transform","fn","literalWithoutBar","join","literal","escapedLiteral","replacement","toString","templateParam","expr","concat","templateWithReplacement","templateWithOutReplacement","template","start","Error","jQuery"],"mappings":"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","file":"jquery.i18n.parser.62304c8c.map","sourceRoot":"../src","sourcesContent":["/*!\n * jQuery Internationalization library\n *\n * Copyright (C) 2011-2013 Santhosh Thottingal, Neil Kandalgaonkar\n *\n * jquery.i18n is dual licensed GPLv2 or later and MIT. You don't have to do\n * anything special to choose one license or the other and you don't have to\n * notify anyone which license you are using. You are free to use\n * UniversalLanguageSelector in commercial projects as long as the copyright\n * header is left intact. See files GPL-LICENSE and MIT-LICENSE for details.\n *\n * @licence GNU General Public Licence 2.0 or later\n * @licence MIT License\n */\n\n( function ( $ ) {\n\t'use strict';\n\n\tvar MessageParser = function ( options ) {\n\t\tthis.options = $.extend( {}, $.i18n.parser.defaults, options );\n\t\tthis.language = $.i18n.languages[ String.locale ] || $.i18n.languages[ 'default' ];\n\t\tthis.emitter = $.i18n.parser.emitter;\n\t};\n\n\tMessageParser.prototype = {\n\n\t\tconstructor: MessageParser,\n\n\t\tsimpleParse: function ( message, parameters ) {\n\t\t\treturn message.replace( /\\$(\\d+)/g, function ( str, match ) {\n\t\t\t\tvar index = parseInt( match, 10 ) - 1;\n\n\t\t\t\treturn parameters[ index ] !== undefined ? parameters[ index ] : '$' + match;\n\t\t\t} );\n\t\t},\n\n\t\tparse: function ( message, replacements ) {\n\t\t\tif ( message.indexOf( '{{' ) < 0 ) {\n\t\t\t\treturn this.simpleParse( message, replacements );\n\t\t\t}\n\n\t\t\tthis.emitter.language = $.i18n.languages[ $.i18n().locale ] ||\n\t\t\t\t$.i18n.languages[ 'default' ];\n\n\t\t\treturn this.emitter.emit( this.ast( message ), replacements );\n\t\t},\n\n\t\tast: function ( message ) {\n\t\t\tvar pipe, colon, backslash, anyCharacter, dollar, digits, regularLiteral,\n\t\t\t\tregularLiteralWithoutBar, regularLiteralWithoutSpace, escapedOrLiteralWithoutBar,\n\t\t\t\tescapedOrRegularLiteral, templateContents, templateName, openTemplate,\n\t\t\t\tcloseTemplate, expression, paramExpression, result,\n\t\t\t\tpos = 0;\n\n\t\t\t// Try parsers until one works, if none work return null\n\t\t\tfunction choice( parserSyntax ) {\n\t\t\t\treturn function () {\n\t\t\t\t\tvar i, result;\n\n\t\t\t\t\tfor ( i = 0; i < parserSyntax.length; i++ ) {\n\t\t\t\t\t\tresult = parserSyntax[ i ]();\n\n\t\t\t\t\t\tif ( result !== null ) {\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn null;\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// Try several parserSyntax-es in a row.\n\t\t\t// All must succeed; otherwise, return null.\n\t\t\t// This is the only eager one.\n\t\t\tfunction sequence( parserSyntax ) {\n\t\t\t\tvar i, res,\n\t\t\t\t\toriginalPos = pos,\n\t\t\t\t\tresult = [];\n\n\t\t\t\tfor ( i = 0; i < parserSyntax.length; i++ ) {\n\t\t\t\t\tres = parserSyntax[ i ]();\n\n\t\t\t\t\tif ( res === null ) {\n\t\t\t\t\t\tpos = originalPos;\n\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\tresult.push( res );\n\t\t\t\t}\n\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\t// Run the same parser over and over until it fails.\n\t\t\t// Must succeed a minimum of n times; otherwise, return null.\n\t\t\tfunction nOrMore( n, p ) {\n\t\t\t\treturn function () {\n\t\t\t\t\tvar originalPos = pos,\n\t\t\t\t\t\tresult = [],\n\t\t\t\t\t\tparsed = p();\n\n\t\t\t\t\twhile ( parsed !== null ) {\n\t\t\t\t\t\tresult.push( parsed );\n\t\t\t\t\t\tparsed = p();\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( result.length < n ) {\n\t\t\t\t\t\tpos = originalPos;\n\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn result;\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// Helpers -- just make parserSyntax out of simpler JS builtin types\n\n\t\t\tfunction makeStringParser( s ) {\n\t\t\t\tvar len = s.length;\n\n\t\t\t\treturn function () {\n\t\t\t\t\tvar result = null;\n\n\t\t\t\t\tif ( message.slice( pos, pos + len ) === s ) {\n\t\t\t\t\t\tresult = s;\n\t\t\t\t\t\tpos += len;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn result;\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tfunction makeRegexParser( regex ) {\n\t\t\t\treturn function () {\n\t\t\t\t\tvar matches = message.slice( pos ).match( regex );\n\n\t\t\t\t\tif ( matches === null ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\tpos += matches[ 0 ].length;\n\n\t\t\t\t\treturn matches[ 0 ];\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tpipe = makeStringParser( '|' );\n\t\t\tcolon = makeStringParser( ':' );\n\t\t\tbackslash = makeStringParser( '\\\\' );\n\t\t\tanyCharacter = makeRegexParser( /^./ );\n\t\t\tdollar = makeStringParser( '$' );\n\t\t\tdigits = makeRegexParser( /^\\d+/ );\n\t\t\tregularLiteral = makeRegexParser( /^[^{}[\\]$\\\\]/ );\n\t\t\tregularLiteralWithoutBar = makeRegexParser( /^[^{}[\\]$\\\\|]/ );\n\t\t\tregularLiteralWithoutSpace = makeRegexParser( /^[^{}[\\]$\\s]/ );\n\n\t\t\t// There is a general pattern:\n\t\t\t// parse a thing;\n\t\t\t// if it worked, apply transform,\n\t\t\t// otherwise return null.\n\t\t\t// But using this as a combinator seems to cause problems\n\t\t\t// when combined with nOrMore().\n\t\t\t// May be some scoping issue.\n\t\t\tfunction transform( p, fn ) {\n\t\t\t\treturn function () {\n\t\t\t\t\tvar result = p();\n\n\t\t\t\t\treturn result === null ? null : fn( result );\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// Used to define \"literals\" within template parameters. The pipe\n\t\t\t// character is the parameter delimeter, so by default\n\t\t\t// it is not a literal in the parameter\n\t\t\tfunction literalWithoutBar() {\n\t\t\t\tvar result = nOrMore( 1, escapedOrLiteralWithoutBar )();\n\n\t\t\t\treturn result === null ? null : result.join( '' );\n\t\t\t}\n\n\t\t\tfunction literal() {\n\t\t\t\tvar result = nOrMore( 1, escapedOrRegularLiteral )();\n\n\t\t\t\treturn result === null ? null : result.join( '' );\n\t\t\t}\n\n\t\t\tfunction escapedLiteral() {\n\t\t\t\tvar result = sequence( [ backslash, anyCharacter ] );\n\n\t\t\t\treturn result === null ? null : result[ 1 ];\n\t\t\t}\n\n\t\t\tchoice( [ escapedLiteral, regularLiteralWithoutSpace ] );\n\t\t\tescapedOrLiteralWithoutBar = choice( [ escapedLiteral, regularLiteralWithoutBar ] );\n\t\t\tescapedOrRegularLiteral = choice( [ escapedLiteral, regularLiteral ] );\n\n\t\t\tfunction replacement() {\n\t\t\t\tvar result = sequence( [ dollar, digits ] );\n\n\t\t\t\tif ( result === null ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn [ 'REPLACE', parseInt( result[ 1 ], 10 ) - 1 ];\n\t\t\t}\n\n\t\t\ttemplateName = transform(\n\t\t\t\t// see $wgLegalTitleChars\n\t\t\t\t// not allowing : due to the need to catch \"PLURAL:$1\"\n\t\t\t\tmakeRegexParser( /^[ !\"$&'()*,./0-9;=?@A-Z^_`a-z~\\x80-\\xFF+-]+/ ),\n\n\t\t\t\tfunction ( result ) {\n\t\t\t\t\treturn result.toString();\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tfunction templateParam() {\n\t\t\t\tvar expr,\n\t\t\t\t\tresult = sequence( [ pipe, nOrMore( 0, paramExpression ) ] );\n\n\t\t\t\tif ( result === null ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\texpr = result[ 1 ];\n\n\t\t\t\t// use a \"CONCAT\" operator if there are multiple nodes,\n\t\t\t\t// otherwise return the first node, raw.\n\t\t\t\treturn expr.length > 1 ? [ 'CONCAT' ].concat( expr ) : expr[ 0 ];\n\t\t\t}\n\n\t\t\tfunction templateWithReplacement() {\n\t\t\t\tvar result = sequence( [ templateName, colon, replacement ] );\n\n\t\t\t\treturn result === null ? null : [ result[ 0 ], result[ 2 ] ];\n\t\t\t}\n\n\t\t\tfunction templateWithOutReplacement() {\n\t\t\t\tvar result = sequence( [ templateName, colon, paramExpression ] );\n\n\t\t\t\treturn result === null ? null : [ result[ 0 ], result[ 2 ] ];\n\t\t\t}\n\n\t\t\ttemplateContents = choice( [\n\t\t\t\tfunction () {\n\t\t\t\t\tvar res = sequence( [\n\t\t\t\t\t\t// templates can have placeholders for dynamic\n\t\t\t\t\t\t// replacement eg: {{PLURAL:$1|one car|$1 cars}}\n\t\t\t\t\t\t// or no placeholders eg:\n\t\t\t\t\t\t// {{GRAMMAR:genitive|{{SITENAME}}}\n\t\t\t\t\t\tchoice( [ templateWithReplacement, templateWithOutReplacement ] ),\n\t\t\t\t\t\tnOrMore( 0, templateParam )\n\t\t\t\t\t] );\n\n\t\t\t\t\treturn res === null ? null : res[ 0 ].concat( res[ 1 ] );\n\t\t\t\t},\n\t\t\t\tfunction () {\n\t\t\t\t\tvar res = sequence( [ templateName, nOrMore( 0, templateParam ) ] );\n\n\t\t\t\t\tif ( res === null ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn [ res[ 0 ] ].concat( res[ 1 ] );\n\t\t\t\t}\n\t\t\t] );\n\n\t\t\topenTemplate = makeStringParser( '{{' );\n\t\t\tcloseTemplate = makeStringParser( '}}' );\n\n\t\t\tfunction template() {\n\t\t\t\tvar result = sequence( [ openTemplate, templateContents, closeTemplate ] );\n\n\t\t\t\treturn result === null ? null : result[ 1 ];\n\t\t\t}\n\n\t\t\texpression = choice( [ template, replacement, literal ] );\n\t\t\tparamExpression = choice( [ template, replacement, literalWithoutBar ] );\n\n\t\t\tfunction start() {\n\t\t\t\tvar result = nOrMore( 0, expression )();\n\n\t\t\t\tif ( result === null ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\n\t\t\t\treturn [ 'CONCAT' ].concat( result );\n\t\t\t}\n\n\t\t\tresult = start();\n\n\t\t\t/*\n\t\t\t * For success, the pos must have gotten to the end of the input\n\t\t\t * and returned a non-null.\n\t\t\t * n.b. This is part of language infrastructure, so we do not throw an\n\t\t\t * internationalizable message.\n\t\t\t */\n\t\t\tif ( result === null || pos !== message.length ) {\n\t\t\t\tthrow new Error( 'Parse error at position ' + pos.toString() + ' in input: ' + message );\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t};\n\n\t$.extend( $.i18n.parser, new MessageParser() );\n}( jQuery ) );\n"]}